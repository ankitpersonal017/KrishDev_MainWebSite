<!DOCTYPE html>
<html lang="en">

<head>

    <!-- metas -->
    <meta charset="utf-8">
    <meta name="author" content="Website Design Templates">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="keywords" content="Multi Purpose HTML5 Template">
    <meta name="description" content="KrishDev Herbal - Multi Purpose HTML5 Template">

    <!-- title  -->
    <title>KrishDev Herbal - Multi Purpose HTML5 Template</title>

    <!-- favicon -->
    <link rel="shortcut icon" href="img/logos/favicon.png">
    <link rel="apple-touch-icon" href="img/logos/apple-touch-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="72x72" href="img/logos/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="114x114" href="img/logos/apple-touch-icon-114x114.png">

    <!-- plugins -->
    <link rel="stylesheet" href="src/css/plugins.css">

    <!-- search css -->
    <link rel="stylesheet" href="src/search/search.css">

    <!-- quform css -->
    <link rel="stylesheet" href="src/quform/css/base.css">

    <!-- theme core css -->
    <link href="src/css/styles.css" rel="stylesheet" id="colors">

    <style>
        .error-text {
            color: #d9534f;
            font-size: 13px;
            margin-top: 5px;
            display: block;
        }

        .error-border {
            border-color: #d9534f !important;
            box-shadow: none !important;
        }
    </style>
</head>

<body>

    <!-- PAGE LOADING
    ================================================== -->
    <div id="preloader">
        <div class="row loader">
            <div class="loader-icon"></div>
        </div>
    </div>

    <!-- MAIN WRAPPER
    ================================================== -->

    <div class="main-wrapper">

        <header class="header-style1 menu_area-light">

            <div class="navbar-default border-bottom border-color-light-white">

                <!-- start top search -->
                <div class="top-search bg-primary">
                    <div class="container">
                        <form class="search-form" action="https://aliconhtml.websitelayout.net/search.html" method="GET"
                            accept-charset="utf-8">
                            <div class="input-group">
                                <span class="input-group-addon cursor-pointer">
                                    <button class="search-form_submit fas fa-search text-white" type="submit"></button>
                                </span>
                                <input type="text" class="search-form_input form-control" name="s" autocomplete="off"
                                    placeholder="Type & hit enter...">
                                <span class="input-group-addon close-search mt-1"><i class="fas fa-times"></i></span>
                            </div>
                        </form>
                    </div>
                </div>
                <!-- end top search -->
                <div class="container">
                    <div class="row align-items-center">
                        <div class="col-12 col-lg-12">
                            <div class="menu_area alt-font">
                                <nav class="navbar navbar-expand-lg navbar-light p-0">

                                    <div class="navbar-header navbar-header-custom">
                                        <!-- start logo -->
                                        <a href="https://aliconhtml.websitelayout.net/index.html"
                                            class="navbar-brand"><img id="logo" src="src/img/logos/logo-inner.jpeg"
                                                alt="logo"></a>
                                        <!-- end logo -->
                                    </div>

                                    <div class="navbar-toggler"></div>

                                    <!-- menu area -->
                                    <ul class="navbar-nav ml-auto" id="nav" style="display: none;">
                                        <li>
                                            <a class="text-capitalize" href="index.html">Home</a>
                                        </li>
                                        <li>
                                            <a class="text-capitalize" href="about.html">About Us</a>
                                        </li>
                                        <li>
                                            <a class="text-capitalize" href="opportunity.html">Opportunity</a>
                                        </li>
                                        <li>
                                            <a class="text-capitalize" href="legals.html">Legals</a>
                                        </li>
                                        <li><a class="text-capitalize" href="#!">Login</a>
                                            <ul>
                                                <li><a class="text-capitalize" href="shoppy_login.html">Shoppy</a></li>
                                                <li><a class="text-capitalize" href="members_login.html">Members</a>
                                                </li>
                                            </ul>
                                        </li>
                                        <li>
                                            <a class="text-capitalize" href="register.html">Member SignUp</a>
                                        </li>
                                        <li>
                                            <a class="text-capitalize" href="contact.html">Contact</a>
                                        </li>
                                        <li>
                                            <a class="text-capitalize" href="inquiry.html">Inquiry</a>
                                        </li>
                                    </ul>
                                    <!-- end menu area -->


                                </nav>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </header>

        <!-- PAGE TITLE
        ================================================== -->
        <section class="page-title-section top-position bg-img cover-background" data-overlay-dark="5"
            data-background="src/img/bg-page-title.jpg">
            <div class="container">

                <div class="row">
                    <div class="col-md-12">
                        <h1>Member SignUp</h1>
                    </div>
                    <div class="col-md-12">
                        <ul>
                            <li><a href="index.html">Home</a></li>
                            <li class="text-light">></li>
                            <li><a href="#!">Member SignUp</a></li>
                        </ul>
                    </div>
                </div>

            </div>
        </section>

        <!-- REGISTER FORM
        ================================================== -->
        <section class="bg-light p-0">

            <div class="container d-flex flex-column">
                <div class="row align-items-center justify-content-center min-vh-100">
                    <div class="col-12 col-sm-12 col-md-12 col-lg-10">

                        <!-- Form -->
                        <div class="card p-2-0 p-sm-2-5 my-2-0">

                            <div class="mb-4 text-center">
                                <h2 class="font-weight-normal mb-0">Welcome to <span class="text-primary text-nowrap font-weight-bold">KrishDev
                                        Herbal</span></h2>
                                <p class="mb-0">Register to your account.</p>
                            </div>

                            <form id="registerForm" novalidate>

                                <div class="row">
                                    <!-- Input -->
                                    <div class="col-12 col-sm-12 col-md-6 col-lg-4">
                                        <div class="form-group">
                                            <label>Sponser ID. Number</label>
                                            <input type="text" id="sponserId" class="form-control required"
                                                name="sponserId" placeholder="Sponser ID">
                                        </div>
                                    </div>
                                    <!-- End Input -->
                                    <!-- Input -->
                                    <div class="col-12 col-sm-12 col-md-6 col-lg-4">
                                        <div class="form-group">
                                            <label>Sponser name</label>
                                            <input type="text" id="sponserName" class="form-control" disabled
                                                name="sponserName" placeholder="Sponser name">
                                        </div>
                                    </div>
                                    <!-- End Input -->



                                    <div class="col-12 col-sm-12 col-md-6 col-lg-4">
                                        <div class="form-group">
                                            <label>Position</label>
                                            <select class="form-control required" name="position" id="position">
                                                <option value="" disabled selected>Select position</option>
                                                <option value="LEFT">Left</option>
                                                <option value="RIGHT">Right</option>
                                            </select>
                                        </div>
                                    </div>

                                    <div class="col-12 col-sm-12 col-md-6 col-lg-4">
                                        <div class="form-group">
                                            <label>Full Name</label>
                                            <input type="text" id="fullName" class="form-control required"
                                                name="fullName" placeholder="Full name">
                                        </div>
                                    </div>

                                    <div class="col-12 col-sm-12 col-md-6 col-lg-4">
                                        <div class="form-group">
                                            <label>Mobile Number</label>
                                            <input type="text" id="mobileNo" maxlength="10"
                                                class="form-control required" name="mobileNo"
                                                placeholder="Mobile number">
                                        </div>
                                    </div>

                                    <div class="col-12 col-sm-12 col-md-6 col-lg-4">
                                        <div class="form-group">
                                            <label>Date of Birth</label>
                                            <input type="date" id="dateOfBirth" name="dateOfBirth" class="form-control required">
                                        </div>
                                    </div>



                                    <div class="col-12 col-sm-12 col-md-6 col-lg-4">
                                        <div class="form-group">
                                            <label>Aadhar Card No</label>
                                            <input type="text" id="aadharCard" maxlength="12" class="form-control required"
                                                name="aadharCard" placeholder="Aadhar Card No">
                                        </div>
                                    </div>

                                    <div class="col-12 col-sm-12 col-md-6 col-lg-4">
                                        <div class="form-group">
                                            <label>Pan Card No</label>
                                            <input type="text" id="panCardNo" maxlength="10" class="form-control required"
                                                name="panCardNo" placeholder="Pan Card No">
                                        </div>
                                    </div>

                                    <div class="col-12 col-sm-12 col-md-6 col-lg-4">
                                        <div class="form-group">
                                            <label>Address</label>
                                            <textarea type="text" id="fullAddress" class="form-control required" rows="3"
                                                name="fullAddress" placeholder="Full Address"></textarea>
                                        </div>
                                    </div>

                                    <div class="col-12 col-sm-12 col-md-6 col-lg-4">
                                        <div class="form-group">
                                            <label>City</label>
                                            <input type="text" id="city" class="form-control required" name="city"
                                                placeholder="City">
                                        </div>
                                    </div>

                                    <div class="col-12 col-sm-12 col-md-6 col-lg-4">
                                        <div class="form-group">
                                            <label>State</label>
                                            <select class="form-control required" name="state" id="state">
                                                <option value="">Select State</option>
                                                <option value="Andhra Pradesh">Andhra Pradesh</option>
                                                <option value="Arunachal Pradesh">Arunachal Pradesh</option>
                                                <option value="Assam">Assam</option>
                                                <option value="Bihar">Bihar</option>
                                                <option value="Chhattisgarh">Chhattisgarh</option>
                                                <option value="Goa">Goa</option>
                                                <option value="Gujarat">Gujarat</option>
                                                <option value="Haryana">Haryana</option>
                                                <option value="Himachal Pradesh">Himachal Pradesh</option>
                                                <option value="Jharkhand">Jharkhand</option>
                                                <option value="Karnataka">Karnataka</option>
                                                <option value="Kerala">Kerala</option>
                                                <option value="Maharashtra">Maharashtra</option>
                                                <option value="Madhya Pradesh">Madhya Pradesh</option>
                                                <option value="Manipur">Manipur</option>
                                                <option value="Meghalaya">Meghalaya</option>
                                                <option value="Mizoram">Mizoram</option>
                                                <option value="Nagaland">Nagaland</option>
                                                <option value="Odisha">Odisha</option>
                                                <option value="Punjab">Punjab</option>
                                                <option value="Rajasthan">Rajasthan</option>
                                                <option value="Sikkim">Sikkim</option>
                                                <option value="Tamil Nadu">Tamil Nadu</option>
                                                <option value="Tripura">Tripura</option>
                                                <option value="Telangana">Telangana</option>
                                                <option value="Uttar Pradesh">Uttar Pradesh</option>
                                                <option value="Uttarakhand">Uttarakhand</option>
                                                <option value="West Bengal">West Bengal</option>
                                                <option value="Andaman & Nicobar">Andaman & Nicobar</option>
                                                <option value="Chandigarh">Chandigarh</option>
                                                <option value="Dadra & Nagar Haveli">Dadra & Nagar Haveli</option>
                                                <option value="Daman & Diu">Daman & Diu</option>
                                                <option value="Delhi">Delhi</option>
                                                <option value="Jammu & Kashmir">Jammu & Kashmir</option>
                                                <option value="Ladakh">Ladakh</option>
                                                <option value="Lakshadweep">Lakshadweep</option>
                                                <option value="Puducherry">Puducherry</option>
                                            </select>
                                        </div>
                                    </div>

                                    <div class="col-12 col-sm-12 col-md-6 col-lg-4">
                                        <div class="form-group">
                                            <label>Pincode</label>
                                            <input type="text" id="pinCode" class="form-control required" name="pinCode"
                                                placeholder="Pincode">
                                        </div>
                                    </div>

                                    <div class="col-12 col-sm-12 col-md-6">
                                        <div class="form-group">
                                            <label>Password</label>
                                            <input type="password" id="password" class="form-control required"
                                                name="password" placeholder="Password">
                                        </div>
                                    </div>

                                    <!-- Input -->
                                    <div class="col-12 col-sm-12 col-md-6">
                                        <div class="form-group">
                                            <label>Confirm Password</label>
                                            <input type="password" id="confirm_password" class="form-control required"
                                                name="confirm_password" placeholder="Your confirm password">
                                        </div>
                                    </div>
                                    <!-- End Input -->
                                </div>

                                <div class="row mt-2">
                                    <div class="col-12">
                                        <div class="custom-control custom-checkbox">
                                            <input type="checkbox" class="custom-control-input required"
                                                id="terms-condition" name="terms">
                                            <label class="custom-control-label" for="terms-condition">I agree to the <a
                                                    href="#!">Terms &amp; Conditions</a></label>
                                        </div>
                                    </div>
                                    <div class="col-md-4 center">
                                        <button type="submit" class="butn medium btn-block mt-4 mb-0">Register</button>
                                    </div>
                                </div>

                                <div class="text-center text-small mt-4">
                                    <span>Already have an account? <a href="members_login.html" class="text-green">Login</a></span>
                                </div>

                            </form>
                        </div>
                        <!-- End Form -->
                    </div>
                </div>
            </div>
        </section>
    </div>

    <!-- SCROLL TO TOP
    ================================================== -->
    <a href="#!" class="scroll-to-top"><i class="fas fa-angle-up" aria-hidden="true"></i></a>

    <!-- all js include start -->

    <!-- jquery -->
    <script src="src/js/core.min.js"></script>

    <!-- search -->
    <script src="src/search/search.js"></script>

    <!-- custom scripts -->
    <script src="src/js/main.js"></script>

    <!-- form plugins js -->
    <script src="src/quform/js/plugins.js"></script>

    <!-- form scripts js -->
    <script src="src/quform/js/scripts.js"></script>

    <!-- all js include end -->

    <script>
        (function () {
            const backendBaseUrl = 'http://localhost:5000/api/'; // set backend base URL if needed
            const form = document.getElementById('registerForm');
            const requiredFields = Array.from(form.querySelectorAll('.required'));

            function showError(el, msg) {
                el.classList.add('error-border');
                const container = el.closest('.form-group') || el.parentElement;
                let err = container.querySelector('.error-text');
                if (!err) { err = document.createElement('span'); err.className = 'error-text'; container.appendChild(err); }
                err.textContent = msg;
            }

            function clearError(el) {
                el.classList.remove('error-border');
                const container = el.closest('.form-group') || el.parentElement;
                const err = container.querySelector('.error-text'); if (err) err.remove();
            }

            function validateField(el) {
                const val = (el.value || '').toString().trim();
                if (el.type === 'checkbox') {
                    if (!el.checked) { showError(el, 'This field is required'); return false; }
                    clearError(el); return true;
                }
                if (el.tagName === 'SELECT') {
                    if (!val) { showError(el, 'Please select an option'); return false; }
                    clearError(el); return true;
                }
                if (!val) { showError(el, 'This field is required'); return false; }

                // regex validations
                const mobileRe = /^[6-9]\d{9}$/;
                const aadharRe = /^\d{12}$/;
                const pincodeRe = /^\d{6}$/;
                const panRe = /^[A-Z]{5}\d{4}[A-Z]$/i;
                console.log('Validating field:', el.id, val);
                if (el.id === 'mobileNo') {
                    if (!mobileRe.test(val)) { showError(el, 'Mobile no should be valid 10 digits'); return false; }
                }
                if (el.id === 'aadharCard') {
                    if (!aadharRe.test(val)) { showError(el, 'Aadhar number must be 12 digits'); return false; }
                }
                if (el.id === 'pinCode') {
                    if (!pincodeRe.test(val)) { showError(el, 'Pincode must be 6 digits'); return false; }
                }
                if (el.id === 'panCardNo') {
                    if (!panRe.test(val)) { showError(el, 'PAN should match format (e.g. ABCDE1234F)'); return false; }
                }

                if (el.id === 'confirm_password') {
                    const pwd = document.getElementById('password').value || '';
                    if (val !== pwd) { showError(el, 'Passwords do not match'); return false; }
                }

                clearError(el); return true;
            }

            requiredFields.forEach(el => {
                el.addEventListener('blur', () => validateField(el));
                el.addEventListener('input', () => { if (el.classList.contains('error-border')) validateField(el); });
            });

            // restrict allowed input characters for specific fields
            const numericOnlyIds = ['sponserId', 'mobileNo', 'aadharCard', 'pinCode'];
            numericOnlyIds.forEach(id => {
                const el = document.getElementById(id);
                if (!el) return;
                el.addEventListener('input', () => {
                    const clean = el.value.replace(/\D/g, '');
                    if (el.value !== clean) el.value = clean;
                    if (el.classList.contains('error-border')) validateField(el);
                });
            });

            const panEl = document.getElementById('panCardNo');
            if (panEl) {
                panEl.addEventListener('input', () => {
                    const clean = panEl.value.toUpperCase().replace(/[^A-Z0-9]/g, '');
                    if (panEl.value !== clean) panEl.value = clean;
                    if (panEl.classList.contains('error-border')) validateField(panEl);
                });
            }

            

            // pincode lookup on blur when 6 digits entered
            const pincodeEl = document.getElementById('pinCode');
            if (pincodeEl) {
                pincodeEl.addEventListener('blur', function () {
                    const pin = (this.value || '').toString().trim();
                    if (pin.length === 6) {
                        lookupPincode(pin);
                    }
                });
            }

            function lookupPincode(pin) {
                fetch(`${backendBaseUrl}commonDetails/pincode/${encodeURIComponent(pin)}`)
                    .then(r => r.ok ? r.json() : Promise.reject(r))
                    .then(data => {
                        data = data?.data || {};
                        // try common shapes
                        if (!data) return;
                        console.log('Pincode lookup data:', data);
                        // If server returns {city,state}
                        if (data.city || data.state) {
                            if (data.city) document.getElementById('city').value = data.city;
                            if (data.state) document.getElementById('state').value = data.state;
                            clearError(pincodeEl);
                            clearError(document.getElementById('city'));
                            clearError(document.getElementById('state'));
                            return;
                        }
                        // If server returns array of post offices
                        if (Array.isArray(data) && data.length) {
                            const first = data[0];
                            if (first.district || first.block || first.taluk) document.getElementById('city').value = first.district || first.block || first.taluk;
                            if (first.state) document.getElementById('state').value = first.state;
                            clearError(pincodeEl);
                            clearError(document.getElementById('city'));
                            clearError(document.getElementById('state'));
                        }
                    })
                    .catch(() => {
                        showError(pincodeEl, 'Pincode lookup failed or not found');
                    });
            }

            // pincode lookup on blur when 6 digits entered
            const sponserId = document.getElementById('sponserId');
            if (sponserId) {
                sponserId.addEventListener('blur', function () {
                    const sponser = (this.value || '').toString().trim();
                    if (sponser.length === 6) {
                        lookupSponser(sponser);
                    }
                });
            }

            function lookupSponser(sponser) {
                fetch(`${backendBaseUrl}memberDetail/${encodeURIComponent(sponser)}`)
                    .then(r => r.ok ? r.json() : Promise.reject(r))
                    .then(data => {
                        data = data?.data || {};
                        // try common shapes
                        if (!data) return;
                        console.log('Sponser lookup data:', data);
                        // If server returns {name}
                        if (data.fullName) {
                            document.getElementById('sponserName').value = data.fullName + ' ( ' + data.mobileNo + ' )';
                            clearError(sponserId);
                            return;
                        }
                    })
                    .catch(() => {
                        showError(sponserId, 'Sponser not found');
                        document.getElementById('sponserName').value = '';
                    });
            }

            function clearForm() {
                const els = Array.from(form.querySelectorAll('[name]'));
                els.forEach(el => {
                    if (el.type === 'checkbox' || el.type === 'radio') el.checked = false;
                    else if (el.tagName === 'SELECT') el.selectedIndex = 0;
                    else el.value = '';
                    clearError(el);
                });
            }

            form.addEventListener('submit', function (e) {
                e.preventDefault();
                let valid = true;
                requiredFields.forEach(el => { if (!validateField(el)) valid = false; });
                if (!valid) return;

                // collect all named fields (include disabled values too)
                const data = {};
                Array.from(form.querySelectorAll('[name]')).forEach(el => {
                    const name = el.getAttribute('name');
                    if (!name) return;
                    if (el.type === 'checkbox') data[name] = !!el.checked;
                    else data[name] = el.value;
                });

                fetch(`${backendBaseUrl}memberDetail/quickJoining`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(data)
                })
                    .then(res => {
                        if (res.ok) return res.json().catch(() => ({}));
                        return res.json().then(body => Promise.reject(body));
                    })
                    .then(resp => {
                        // success: clear form and show confirmation
                        clearForm();
                        alert((resp && resp.message) ? resp.message : 'Registration successful');
                        // optionally redirect or additional UI handling here
                    })
                    .catch(err => {
                        const msg = (err && err.message) ? err.message : 'Registration failed';
                        alert(msg);
                    });
            });
        })();
    </script>

</body>

</html>