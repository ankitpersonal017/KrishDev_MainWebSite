
<!DOCTYPE html>
<html lang="en">

<head>

    <!-- metas -->
    <meta charset="utf-8">
    <meta name="author" content="Website Design Templates">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="keywords" content="KrishDev Herbal, Shoppy Login">
    <meta name="description" content="Shoppy login for KrishDev Herbal â€” access your shoppy account.">

    <!-- title  -->
    <title>KrishDev Herbal - Shoppy Login</title>

    <!-- favicon -->
    <link rel="shortcut icon" href="src/img/logos/favicon.png">
    <link rel="stylesheet" href="src/css/plugins.css" />
    <link rel="stylesheet" href="src/css/search.css" />
    <link rel="stylesheet" href="src/css/base.css" />

    <!-- theme core css -->
    <link href="src/css/styles.css" rel="stylesheet" id="colors">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
     <style>
        .error-text{ color:#d9534f; font-size:13px; margin-top:5px; display:block; }
        .error-border{ border-color:#d9534f !important; box-shadow:none !important; }
    </style>
</head>

<body>

    <!-- PAGE LOADING
    ================================================== -->
    <div id="preloader">
        <div class="row loader">
            <div class="loader-icon"></div>
        </div>
    </div>

    <!-- MAIN WRAPPER
    ================================================== -->
    <div class="main-wrapper">

        <header class="header-style1 menu_area-light">

            <div class="navbar-default border-bottom border-color-light-white">

                <!-- start top search -->
                <div class="top-search bg-primary">
                    <div class="container">
                        <form class="search-form" action="https://aliconhtml.websitelayout.net/search.html" method="GET" accept-charset="utf-8">
                            <div class="input-group">
                                <span class="input-group-addon cursor-pointer">
                                    <button class="search-form_submit fas fa-search text-white" type="submit"></button>
                                </span>
                                <input type="text" class="search-form_input form-control" name="s" autocomplete="off" placeholder="Type & hit enter...">
                                <span class="input-group-addon close-search mt-1"><i class="fas fa-times"></i></span>
                            </div>
                        </form>
                    </div>
                </div>
                <!-- end top search -->
                <div class="container">
                    <div class="row align-items-center">
                        <div class="col-12 col-lg-12">
                            <div class="menu_area alt-font">
                                <nav class="navbar navbar-expand-lg navbar-light p-0">

                                    <div class="navbar-header navbar-header-custom">
                                        <!-- start logo -->
                                        <a href="https://aliconhtml.websitelayout.net/index.html" class="navbar-brand"><img id="logo" src="src/img/logos/logo-inner.png" alt="logo"></a>
                                        <!-- end logo -->
                                    </div>

                                    <div class="navbar-toggler"></div>

                                    <!-- menu area -->
                                    <ul class="navbar-nav ml-auto" id="nav" style="display: none;">
                                        <li>
                                            <a class="text-capitalize" href="index.html">Home</a>                                            
                                        </li>
                                        <li>
                                            <a class="text-capitalize" href="about.html">About Us</a>                                            
                                        </li>
                                        <li>
                                            <a class="text-capitalize" href="opportunity.html">Opportunity</a>
                                        </li>
                                        <li>
                                            <a class="text-capitalize" href="legals.html">Legals</a>
                                        </li>
                                        <li><a class="text-capitalize" href="#!">Login</a>
                                            <ul>
                                                <li><a class="text-capitalize" href="shoppy_login.html">Shoppy</a></li>
                                                <li><a class="text-capitalize" href="members_login.html">Members</a></li>
                                            </ul>
                                        </li>
                                        <li>
                                            <a class="text-capitalize" href="register.html">Member SignUp</a>                                            
                                        </li>
                                        <li>
                                            <a class="text-capitalize" href="contact.html">Contact</a>                                            
                                        </li>
                                        <li>
                                            <a class="text-capitalize" href="inquiry.html">Inquiry</a>                                            
                                        </li>
                                    </ul>
                                    <!-- end menu area -->


                                </nav>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </header>

        <!-- PAGE TITLE
        ================================================== -->
        <section class="page-title-section top-position bg-img cover-background" data-overlay-dark="5" data-background="src/img/bg-page-title.jpg">
            <div class="container">

                <div class="row">
                    <div class="col-md-12">
                        <h1>Login</h1>
                    </div>
                    <div class="col-md-12">
                        <ul>
                            <li><a href="index.html">Home</a></li>
                            <li class="text-light">></li>
                            <li><a href="#!">Shoppy Login</a></li>
                        </ul>
                    </div>
                </div>

            </div>
        </section>

        <!-- LOGIN FORM
        ================================================== -->
        <section class="bg-light p-0">
            <div class="container d-flex flex-column">

                <div class="row align-items-center justify-content-center min-vh-100">
                    <div class="col-sm-11 col-md-8 col-lg-7 col-xl-6">

                        <div class="card p-2-0 p-sm-2-5 my-2-0">

                            <div class="mb-4 text-center">
                                <h2 class="font-weight-normal mb-0">Welcome to <span class="text-primary text-nowrap font-weight-bold">KrishDev Herbal</span></h2>
                                <p class="mb-0">Shoppy Login to your account.</p>
                            </div>

                            <!-- Form -->
                            <form id="loginForm" novalidate>

                                <div class="row">

                                    <!-- Input -->
                                    <div class="col-12">

                                        <div class="form-group">
                                            <label>Username</label>
                                            <input type="text" id="login_username" class="form-control required" maxlength="6" name="username" placeholder="Your username">
                                        </div>

                                    </div>
                                    <!-- End Input -->

                                    <!-- Input -->
                                    <div class="col-12">

                                        <div class="form-group">
                                            <label>Password</label>
                                            <input type="password" id="login_password" class="form-control required" minlength="6" maxlength="20" name="password" placeholder="Your password" required>
                                        </div>

                                    </div>
                                    <!-- End Input -->

                                </div>

                                <div class="row mt-2">
                                    <div class="col-sm-6 mb-2 mb-sm-0">
                                        <div class="custom-control custom-checkbox">
                                            <input type="checkbox" class="custom-control-input" id="login-remember">
                                            <label class="custom-control-label" for="login-remember">Keep me signed in</label>
                                        </div>
                                    </div>
                                    <div class="col-sm-6 text-left text-sm-right">
                                        <a href="forgot-password.html" class="m-link-muted small">Forgot password?</a>
                                    </div>

                                    <div class="col-md-12 center">
                                        <button type="button" id="loginBtn" class="butn medium btn-block mt-4 mb-0">Login</button>
                                    </div>
                                </div>

                            </form>
                            <!-- End Form -->

                        </div>

                    </div>
                </div>

            </div>
        </section>

    </div>
    <a href="#!" class="scroll-to-top"><i class="fa fa-angle-up" aria-hidden="true"></i></a>
    <script src="src/js/core.min.js"></script>
    <script src="src/js/search.js"></script>
    <script src="src/js/xhr.js"></script>
    <script src="src/js/main.js"></script>
    <script src="src/js/plugins.js"></script>
    <script src="src/js/scripts.js"></script>
     <script>
        (function(){
            const backendBaseUrl = 'https://krishdevherbal.scorpnidhi.com/api/';
            const loginUsername = document.getElementById('login_username');
            const loginPassword = document.getElementById('login_password');
            const loginBtn = document.getElementById('loginBtn');

            function showError(el, msg){
                if(!el) return;
                el.classList.add('error-border');
                const container = el.closest('.form-group') || el.parentElement;
                let err = container.querySelector('.error-text');
                if(!err){ err = document.createElement('span'); err.className='error-text'; container.appendChild(err); }
                err.textContent = msg;
            }
            function clearError(el){
                if(!el) return;
                el.classList.remove('error-border');
                const container = el.closest('.form-group') || el.parentElement;
                const err = container.querySelector('.error-text'); if(err) err.remove();
            }

            const usernameRe = /^\d{6}$/;
            const passwordMin = 6;
            const passwordMax = 20;

            if(loginUsername){
                loginUsername.addEventListener('input', ()=>{
                    const clean = loginUsername.value.replace(/\D/g,'');
                    if(loginUsername.value !== clean) loginUsername.value = clean;
                    if(loginUsername.classList.contains('error-border')) clearError(loginUsername);
                });
                loginUsername.addEventListener('blur', ()=>{
                    const v = (loginUsername.value||'').trim();
                    if(!usernameRe.test(v)) showError(loginUsername, 'Username must be 6 digits');
                    else clearError(loginUsername);
                });
            }

            if(loginPassword){
                loginPassword.addEventListener('blur', ()=>{
                    const v = (loginPassword.value||'').trim();
                    if(v.length < passwordMin || v.length > passwordMax) showError(loginPassword, 'Password must be 6-20 characters');
                    else clearError(loginPassword);
                });
            }

            if(loginBtn){
                loginBtn.addEventListener('click', ()=>{
                    const u = (loginUsername.value||'').trim();
                    const p = (loginPassword.value||'').trim();
                    let ok = true;
                    if(!usernameRe.test(u)){ showError(loginUsername, 'Username must be 6 digits'); ok = false; }
                    if(p.length < passwordMin || p.length > passwordMax){ showError(loginPassword, 'Password must be 6-20 characters'); ok = false; }
                    if(!ok) return;

                    xhrFetch(`${backendBaseUrl}authenticate/login/franchise`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ username: u, password: p })
                    })
                    .then(function(res){
                        return res.ok ? res.json().catch(function(){ return {}; }) : res.json().then(function(b){ return Promise.reject(b); });
                    })
                    .then(function(data){
                        console.log('Login success:', data.data);
                        clearError(loginUsername); clearError(loginPassword);
                        const authData = data && data.data ? data.data : null;
                        alert(authData.authUser.fullName + ' - ' + authData.authUser.authFor + ' login successful!');
                        if(authData){
                            window.location.href = 'https://member.krishdevherbal.in/#/redirect-auth?token=' + authData.authToken;
                        }
                        loginUsername.value = '';
                        loginPassword.value = '';
                    })
                    .catch(function(err){
                        var msg = (err && err.error.message) ? err.error.message : 'Login failed';
                        alert(msg);
                    });
                });
            }
        })();
    </script>
</body>

</html>